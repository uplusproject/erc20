<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wallet Connect DApp</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px;
        }

        h1 {
            color: #333;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            margin: 10px;
            border: none;
            cursor: pointer;
            font-size: 16px;
        }

        button:hover {
            background-color: #45a049;
        }

        #status {
            margin: 20px 0;
            color: red;
        }

        #languageSelector {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1 id="title">Connect Your Wallet</h1>
    <div id="languageSelector">
        <label for="languages">Select Language:</label>
        <select id="languages" onchange="changeLanguage()">
            <option value="en">English</option>
            <option value="zh">中文</option>
            <option value="ko">한국어</option>
            <option value="ja">日本語</option>
        </select>
    </div>
    <button id="connectButton">Connect Wallet</button>
    <div id="status"></div>

    <script>
        let isWalletConnecting = false;
        const statusElement = document.getElementById('status');
        const titleElement = document.getElementById('title');
        const languages = {
            en: {
                title: "Connect Your Wallet",
                connectButton: "Connect Wallet",
                connecting: "Connecting to wallet...",
                success: "Wallet connected successfully",
                fail: "Failed to connect wallet. Please check your browser extension or try again.",
                walletNotFound: "MetaMask not installed. Please install MetaMask."
            },
            zh: {
                title: "连接您的钱包",
                connectButton: "连接钱包",
                connecting: "正在连接钱包...",
                success: "钱包连接成功",
                fail: "连接失败，请检查浏览器扩展或重试。",
                walletNotFound: "未安装MetaMask。请先安装MetaMask。"
            },
            ko: {
                title: "지갑 연결하기",
                connectButton: "지갑 연결",
                connecting: "지갑에 연결 중...",
                success: "지갑이 성공적으로 연결되었습니다",
                fail: "연결 실패: 브라우저 확장 프로그램을 확인하거나 다시 시도하세요.",
                walletNotFound: "MetaMask가 설치되지 않았습니다. MetaMask를 설치하세요."
            },
            ja: {
                title: "ウォレットを接続",
                connectButton: "ウォレットを接続する",
                connecting: "ウォレットに接続中...",
                success: "ウォレットが正常に接続されました",
                fail: "接続に失敗しました。ブラウザ拡張機能を確認するか、もう一度お試しください。",
                walletNotFound: "MetaMaskがインストールされていません。MetaMaskをインストールしてください。"
            }
        };

        function changeLanguage() {
            const language = document.getElementById('languages').value;
            const selectedLang = languages[language];
            titleElement.innerText = selectedLang.title;
            document.getElementById('connectButton').innerText = selectedLang.connectButton;
        }

        async function connectWallet() {
            if (isWalletConnecting) {
                console.log("连接请求已经挂起，请等待...");
                return;
            }

            statusElement.innerText = languages[document.getElementById('languages').value].connecting;
            isWalletConnecting = true;

            try {
                if (window.ethereum) {
                    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    statusElement.innerText = languages[document.getElementById('languages').value].success + ": " + accounts[0];
                    console.log("钱包已连接:", accounts[0]);
                } else {
                    statusElement.innerText = languages[document.getElementById('languages').value].walletNotFound;
                }
            } catch (error) {
                console.error("连接钱包失败:", error);
                statusElement.innerText = languages[document.getElementById('languages').value].fail;
            } finally {
                isWalletConnecting = false;
            }
        }

        document.getElementById('connectButton').addEventListener('click', connectWallet);
    </script>
</body>
</html>
